function configurePageSizePlugin(){const e=currentRequest().page_size;if(e){const t=document.getElementById(e);t&&(t.checked=!0)}document.querySelectorAll('input[name="page_size"]').forEach((e=>{e.addEventListener("change",(()=>{updatePage(buildRequest(1,selectedSize(),currentRequest().player_name))}))}))}function highlightText(){let e=currentRequest().player_name.endsWith("%")?currentRequest().player_name.slice(0,-1):currentRequest().player_name;const t=document.querySelectorAll("td > a"),n=new RegExp(e,"gi");e.trim()&&t.forEach((e=>{if(e.textContent.match(n)){let t=1===e.children.length;e.innerHTML=e.textContent.replace(n,(e=>`<span class="highlight">${e}</span>`)),t&&(e.innerHTML+='<i class="fa-solid fa-trophy" style="color: rgb(214,154,0)"></i>')}}))}function updateCurrentSearch(){const e=document.querySelector(".current-search"),t=currentRequest().player_name;if(t.trim()){document.querySelector(".current-search-label").textContent=t.endsWith("%")?t.slice(0,-1):t,e.style.display="block"}else e.style.display="none"}function buildRequest(e,t,n){return{page_number:+e,page_size:+t,player_name:n}}function currentRequest(){const e=new URLSearchParams(window.location.search);return buildRequest(e.get("page_number")||1,e.get("page_size")||selectedSize(),e.get("player_name")||"")}function configureSearchBarPlugin(){const e=document.querySelector(".search-box"),t=document.querySelector(".btn-search"),n=document.querySelector(".btn-clear"),a=document.querySelector(".input-search"),r=document.querySelector(".btn-clear-current-search");function i(){"rgba(0, 0, 0, 0)"===window.getComputedStyle(a).backgroundColor&&a.value.trim()?(a.value=a.value.trim(),updatePage(buildRequest(1,currentRequest().page_size,a.value+"%"))):(n.style.display="block",a.focus(),a.classList.add("input-search-full"))}t.addEventListener("click",i),a.addEventListener("keydown",(e=>{"Enter"===e.key&&i()})),r.addEventListener("click",(function(){updatePage(buildRequest(1,currentRequest().page_size,""))})),n.addEventListener("click",(function(){a.value=""})),document.addEventListener("click",(function(t){e.contains(t.target)||(a.classList.remove("input-search-full"),n.style.display="none")}))}function updateUrl(e){let t=context+frontend+"?"+new URLSearchParams(e);window.history.replaceState(null,null,t)}function selectedSize(){const e=document.querySelector('input[name="page_size"]:checked');if(e)return e.id}function removeLoader(){let e=document.querySelector(".bouncing-ball-loader");e&&e.remove()}async function updatePage(e){const t=context+apiJSON+"?"+new URLSearchParams(e).toString();fetch(t).then((e=>e.ok?e.json():e.json().then((e=>{throw new Error(e.message)})))).then((t=>{removeLoader(),fillDataTables(t.entities),highlightText(),configurePaginationPlugin(t.totalPages,e),configureGoButton(t.totalPages)})).catch((e=>{alert(e.message),window.location.href=context})),updateUrl(e),updateCurrentSearch()}function configurePaginationPlugin(e,t){let n=document.querySelector(".match_pagination");n.innerHTML="";let a=createPageButton(n,"Prev");1===t.page_number?a.classList.add("disabled"):a.addEventListener("click",(async function(e){e.preventDefault(),await changePageWithAnimation("prev",buildRequest(--t.page_number,t.page_size,t.player_name))})),e>=6?setupSixOrMorePages(e,t,n):setupFiveOrLessPages(e,t,n);let r=createPageButton(n,"Next");t.page_number===e?r.classList.add("disabled"):r.addEventListener("click",(async function(e){e.preventDefault(),await changePageWithAnimation("next",buildRequest(++t.page_number,t.page_size,t.player_name))}))}async function changePageWithAnimation(e,t){let n=document.querySelector(".item-table");n.classList.add("fade-out-"+e),await new Promise((e=>setTimeout(e,200))),await updatePage(t),n.classList.remove("fade-out-"+e),n.classList.add("fade-in-"+e),setTimeout((()=>{n.classList.remove("fade-in-"+e)}),200)}function configureGoButton(e){const t=document.querySelector(".go-box");t.innerHTML="";const n=document.createElement("button");n.classList.add("btn-go"),n.innerHTML='<i class="fa-solid fa-arrow-right"></i>';const a=document.createElement("input");function r(e){if(a.classList.remove("invalid"),"rgba(0, 0, 0, 0)"===window.getComputedStyle(a).backgroundColor&&a.value.trim()){let t=+a.value.trim(),n=currentRequest().page_number;if(Number.isInteger(t)&&t>=1&&t<=e&&t!==n){changePageWithAnimation(t>n?"next":"prev",buildRequest(t,currentRequest().page_size,currentRequest().player_name))}else a.value="",a.classList.add("invalid"),a.focus()}else a.focus(),a.classList.add("input-go-full")}a.classList.add("input-go"),a.setAttribute("type","text"),a.setAttribute("placeholder","Page..."),t.appendChild(n),t.appendChild(a),n.addEventListener("click",(()=>r(e))),a.addEventListener("keydown",(t=>{"Enter"===t.key&&r(e)})),document.addEventListener("click",(function(e){t.contains(e.target)||a.classList.remove("input-go-full")}))}function setupFiveOrLessPages(e,t,n){for(let a=1;a<=e;a++){checkCurrentNumberPageActive(t,a,createPageButton(n,a))}}function createPageButton(e,t){const n=document.createElement("li");return n.classList.add("page-item"),n.innerHTML=`<a class="page-link" href="#">${t}</a>`,e.appendChild(n),n}function checkCurrentNumberPageActive(e,t,n){e.page_number===t?n.classList.add("active"):n.addEventListener("click",(function(n){n.preventDefault(),changePageWithAnimation(t>e.page_number?"next":"prev",buildRequest(t,e.page_size,e.player_name))}))}function setupSixOrMorePages(e,t,n){let a=createPageButton(n,1);if(checkCurrentNumberPageActive(t,1,a),createPageButton(n,"...").classList.add("disabled","disabled-custom"),1!==t.page_number&&t.page_number!==e){createPageButton(n,t.page_number).classList.add("active")}else{const a=Math.floor(e/2);createPageButton(n,a).addEventListener("click",(function(e){e.preventDefault(),changePageWithAnimation(a>t.page_number?"next":"prev",buildRequest(a,t.page_size,t.player_name))}))}createPageButton(n,"...").classList.add("disabled","disabled-custom");let r=createPageButton(n,e);checkCurrentNumberPageActive(t,e,r)}document.addEventListener("DOMContentLoaded",(function(){configurePageSizePlugin(),configureSearchBarPlugin(),updatePage(currentRequest())}));